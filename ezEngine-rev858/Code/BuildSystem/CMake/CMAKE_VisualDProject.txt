#cmake

# Get the name of this folder
get_filename_component (CUR_FOLDER_NAME ${CMAKE_CURRENT_SOURCE_DIR} NAME_WE)
get_filename_component (PARENT_FOLDER ${CMAKE_CURRENT_SOURCE_DIR} PATH)
get_filename_component (PARENT_FOLDER_NAME ${PARENT_FOLDER} NAME_WE)

message (STATUS "Adding VisualD Project: ${PROJECT_NAME}")

# Add the external DTestLib
file(RELATIVE_PATH RELATIVE_PARENT_FOLDER ${CMAKE_BINARY_DIR} ${CMAKE_CURRENT_SOURCE_DIR})
INCLUDE_EXTERNAL_MSPROJECT("${PROJECT_NAME}_dproj" ${RELATIVE_PARENT_FOLDER}/${PROJECT_NAME}.visualdproj 
                           TYPE 002A2DE9-8BB6-484D-9802-7E4AD4084715
                           GUID ${DPROJ_GUID}
						   ${ADDITIONAL_DEPENDENCIES})
						   
SET_PROPERTY(GLOBAL PROPERTY USE_FOLDERS ON)
file(RELATIVE_PATH RELATIVE_PARENT_FOLDER ${CMAKE_SOURCE_DIR} ${PARENT_FOLDER})
SET_PROPERTY(TARGET ${PROJECT_NAME}_dproj PROPERTY FOLDER ${RELATIVE_PARENT_FOLDER})